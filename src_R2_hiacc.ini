# *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*
# *  CLASS input parameter file  *
# *  R2 High-Accuracy (SRC ON)  *
# *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*

# R2 Precision-stability validation: high-accuracy precision run
# Same physics as src_R2_base.ini but with tighter precision settings

# -------------------------
# ----> General parameters:
# -------------------------

# Output format
output = tCl,pCl,lCl,mPk

# Output root (must include output/ prefix)
root = output/R2_hiacc/R2_hiacc

# Overwrite root (prevent numbering)
overwrite_root = yes

# Write headers
headers = yes

# Format
format = class

# Write flags for detailed analysis
write_background = yes
write_thermodynamics = yes
write_primordial = yes

# Lensing
lensing = yes

# Non-linear corrections
non_linear = halofit

# Initial conditions and modes
ic = ad
modes = s

# Multipole ranges (increased for high accuracy)
l_max_scalars = 3500

# Power spectrum settings
P_k_max_h/Mpc = 1.0
z_pk = 0.,1.

# -------------------------
# ----> Precision parameters (high accuracy):
# -------------------------

# Power spectrum sampling
k_per_decade_for_pk = 50
k_per_decade_for_bao = 80

# Integration tolerances
tol_background_integration = 1e-7
tol_perturb_integration = 1e-6

# Perturbation sampling
perturb_sampling_stepsize = 0.02

# Lensing accuracy
accurate_lensing = yes
lensing_sampling_boost = 1.5

# -------------------------
# ----> Self-Regulating Cosmology:
# -------------------------

# Enable SRC energy transfer
use_src = yes

# SRC parameters (Volume 1/2 values) - same as base
src_gamma0 = 0.02
src_a_peak = 0.78
src_width = 0.12

# -------------------------
# ----> Species parameters:
# -------------------------

# Photon temperature
T_cmb = 2.7255

# Baryon density (Planck 2018-like)
omega_b = 0.02238280

# Cold dark matter density (Planck 2018-like)
omega_cdm = 0.1201075

# Ultra-relativistic species
N_ur = 3.044

# Curvature
Omega_k = 0.0

# Cosmological constant (set to 0 so all dark energy is in fluid)
Omega_Lambda = 0.0

# Dark energy as fluid (required for SRC to work)
# With w = -1, this mimics Î›CDM when use_src = no
# Omega_fld will be computed automatically by CLASS from the closure equation
# Omega_fld = 0.7
fluid_equation_of_state = CLP
w0_fld = -1.0
wa_fld = 0.0
cs2_fld = 1.0

# -------------------------
# ----> Recombination:
# -------------------------

# Reionization optical depth
tau_reio = 0.0543

# Helium fraction
YHe = BBN

# Recombination code
recombination = HyRec

# -------------------------
# ----> Primordial:
# -------------------------

# Primordial spectrum type
P_k_ini type = analytic_Pk

# Scalar amplitude (Planck 2018-like)
A_s = 2.100549e-09

# Scalar spectral index (Planck 2018-like)
n_s = 0.9660499

# Spectrum running
alpha_s = 0.0

# Pivot scale
k_pivot = 0.05

# -------------------------
# ----> Verbosity:
# -------------------------

# Verbosity
input_verbose = 1
background_verbose = 1
thermodynamics_verbose = 1
perturbations_verbose = 1
transfer_verbose = 1
primordial_verbose = 1
harmonic_verbose = 1
fourier_verbose = 1
lensing_verbose = 1
output_verbose = 1

